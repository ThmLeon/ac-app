<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/lib/api/sharepoint/events.ts">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/lib/api/sharepoint/events.ts" />
              <option name="originalContent" value="import type { Database } from '@/api/supabase/database.types';&#10;import type { EventMasterForm } from '@/schemas/eventMasterSchema';&#10;import type { NewEventForm } from '@/schemas/newEventSchema';&#10;import { callSharepointAPI } from '@/utils/utils';&#10;import type { Session, SupabaseClient } from '@supabase/supabase-js';&#10;import { getEventDetailsById, getEventMasterByID } from '../supabase/events';&#10;import type { EventBesetzungAnwesenheitForm } from '@/schemas/eventBesetzungAnwesenheitSchema';&#10;import type { EventBewerbungForm } from '@/schemas/eventBewerbungSchema';&#10;&#10;export async function updateEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventMasterForm&#10;) {&#10;&#9;const { ...data } = formData;&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'update',&#10;&#9;&#9;itemId: formData.ID,&#10;&#9;&#9;formData: data,&#10;&#9;&#9;tableName: '4_EventMaster'&#10;&#9;});&#10;&#9;return;&#10;}&#10;&#10;export async function addEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventMasterForm&#10;) {&#10;&#9;const { ID, ...data } = formData;&#10;&#9;const return_ID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'insert',&#10;&#9;&#9;formData: data,&#10;&#9;&#9;tableName: '4_EventMaster'&#10;&#9;});&#10;&#9;return return_ID;&#10;}&#10;&#10;export async function deleteEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;ID: number&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'delete',&#10;&#9;&#9;itemId: ID,&#10;&#9;&#9;tableName: '4_EventMaster'&#10;&#9;});&#10;&#9;return;&#10;}&#10;&#10;export async function createNewEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: NewEventForm&#10;) {&#10;&#9;//transformData&#10;&#9;let transformedData = { ...formData } as any;&#10;&#9;transformedData['AnlageGew_x00fc_nscht'] = transformedData.AnlageGewuenscht;&#10;&#9;delete transformedData.AnlageGewuenscht;&#10;&#9;transformedData['BewerbungstextGew_x00fc_nscht'] = transformedData.BewerbungstextGewuenscht;&#10;&#9;delete transformedData.BewerbungstextGewuenscht;&#10;&#9;transformedData['AngabeEssgewGew_x00fc_nscht'] = transformedData.AngabeEssgewGewuenscht;&#10;&#9;delete transformedData.AngabeEssgewGewuenscht;&#10;&#9;delete transformedData.EventVerantwortliche; // Remove this field, as it will be handled separately&#10;&#9;delete transformedData.IstHSMEvent;&#10;&#9;delete transformedData.image;&#10;&#10;&#9;let { Eventart } = await getEventMasterByID(supabase, transformedData.MasterEventID);&#10;&#9;transformedData.Eventart = Eventart;&#10;&#10;&#9;let newEventID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'insert',&#10;&#9;&#9;formData: transformedData,&#10;&#9;&#9;tableName: '4_Events'&#10;&#9;});&#10;&#10;&#9;const eventVerantwortlicheIDs: number[] = [];&#10;&#9;for (const verantwortlicher of formData.EventVerantwortliche) {&#10;&#9;&#9;const eventVerantwortlicheID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;&#9;action: 'insert',&#10;&#9;&#9;&#9;formData: {&#10;&#9;&#9;&#9;&#9;Title: verantwortlicher.Titel,&#10;&#9;&#9;&#9;&#9;EventID: newEventID,&#10;&#9;&#9;&#9;&#9;MitgliedID: verantwortlicher.ID,&#10;&#9;&#9;&#9;&#9;Besetzt: true&#10;&#9;&#9;&#9;},&#10;&#9;&#9;&#9;tableName: '4_EventVerantwortliche'&#10;&#9;&#9;});&#10;&#9;&#9;eventVerantwortlicheIDs.push(eventVerantwortlicheID!);&#10;&#9;}&#10;&#10;&#9;return { newEventID, eventVerantwortlicheIDs };&#10;}&#10;&#10;export async function updateEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: NewEventForm,&#10;&#9;eventID: number&#10;) {&#10;&#9;let transformedData = { ...formData } as any;&#10;&#9;transformedData['AnlageGew_x00fc_nscht'] = transformedData.AnlageGewuenscht;&#10;&#9;delete transformedData.AnlageGewuenscht;&#10;&#9;transformedData['BewerbungstextGew_x00fc_nscht'] = transformedData.BewerbungstextGewuenscht;&#10;&#9;delete transformedData.BewerbungstextGewuenscht;&#10;&#9;transformedData['AngabeEssgewGew_x00fc_nscht'] = transformedData.AngabeEssgewGewuenscht;&#10;&#9;delete transformedData.AngabeEssgewGewuenscht;&#10;&#9;delete transformedData.EventVerantwortliche; // Remove this field, as it will be handled separately&#10;&#9;delete transformedData.IstHSMEvent;&#10;&#9;delete transformedData.image;&#10;&#10;&#9;let { Eventart } = await getEventMasterByID(supabase, transformedData.MasterEventID);&#10;&#9;transformedData.Eventart = Eventart;&#10;&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'update',&#10;&#9;&#9;itemId: eventID,&#10;&#9;&#9;formData: transformedData,&#10;&#9;&#9;tableName: '4_Events'&#10;&#9;});&#10;&#10;&#9;const { eventDetails } = await getEventDetailsById(supabase, eventID, 0);&#10;&#9;for (const ev of eventDetails.eventVerantwortliche) {&#10;&#9;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;&#9;action: 'delete',&#10;&#9;&#9;&#9;itemId: ev.ID,&#10;&#9;&#9;&#9;tableName: '4_EventVerantwortliche'&#10;&#9;&#9;});&#10;&#9;}&#10;&#10;&#9;const eventVerantwortlicheIDs: number[] = [];&#10;&#9;for (const ev of formData.EventVerantwortliche) {&#10;&#9;&#9;const eventVerantwortlicheID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;&#9;action: 'insert',&#10;&#9;&#9;&#9;formData: {&#10;&#9;&#9;&#9;&#9;Title: ev.Titel,&#10;&#9;&#9;&#9;&#9;EventID: eventID,&#10;&#9;&#9;&#9;&#9;MitgliedID: ev.ID,&#10;&#9;&#9;&#9;&#9;Besetzt: true&#10;&#9;&#9;&#9;},&#10;&#9;&#9;&#9;tableName: '4_EventVerantwortliche'&#10;&#9;&#9;});&#10;&#9;&#9;eventVerantwortlicheIDs.push(eventVerantwortlicheID!);&#10;&#9;}&#10;&#9;return eventVerantwortlicheIDs;&#10;}&#10;&#10;export async function createEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventBewerbungForm,&#10;&#9;eventId: number,&#10;&#9;userTitel: string,&#10;&#9;userId: number&#10;) {&#10;&#9;let besetzt: boolean = formData.Anmeldeart != 'Bewerben';&#10;&#10;&#9;const newApplicationID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'insert',&#10;&#9;&#9;formData: {&#10;&#9;&#9;&#9;Title: userTitel,&#10;&#9;&#9;&#9;EventID: eventId,&#10;&#9;&#9;&#9;MitgliedID: userId,&#10;&#9;&#9;&#9;BewerbungText: formData.BewerbungText,&#10;&#9;&#9;&#9;Besetzt: besetzt,&#10;&#9;&#9;&#9;Anwesend: false,&#10;&#9;&#9;&#9;Essgewohnheiten: formData.Essgewohnheiten&#10;&#9;&#9;},&#10;&#9;&#9;tableName: '4_EventBewerbungen'&#10;&#9;});&#10;&#9;return newApplicationID!;&#10;}&#10;&#10;export async function updateEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventBewerbungForm&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'update',&#10;&#9;&#9;formData: {&#10;&#9;&#9;&#9;BewerbungText: formData.BewerbungText,&#10;&#9;&#9;&#9;Essgewohnheiten: formData.Essgewohnheiten&#10;&#9;&#9;},&#10;&#9;&#9;tableName: '4_EventBewerbungen',&#10;&#9;&#9;itemId: formData.ID&#10;&#9;});&#10;}&#10;&#10;export async function deleteEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;applicationId: number&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'delete',&#10;&#9;&#9;itemId: applicationId,&#10;&#9;&#9;tableName: '4_EventBewerbungen'&#10;&#9;});&#10;}&#10;&#10;export async function deleteEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;eventId: number&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'delete',&#10;&#9;&#9;itemId: eventId,&#10;&#9;&#9;tableName: '4_Events'&#10;&#9;});&#10;}&#10;&#10;export async function setEventBesetzungAnwesenheit(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventBesetzungAnwesenheitForm&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'update',&#10;&#9;&#9;itemId: formData.ID,&#10;&#9;&#9;formData: {&#10;&#9;&#9;&#9;Besetzt: formData.Besetzt,&#10;&#9;&#9;&#9;Anwesend: formData.Anwesend&#10;&#9;&#9;},&#10;&#9;&#9;tableName: '4_EventBewerbungen'&#10;&#9;});&#10;}&#10;" />
              <option name="updatedContent" value="import type { Database } from '@/api/supabase/database.types';&#10;import type { EventMasterForm } from '@/schemas/eventMasterSchema';&#10;import type { NewEventForm } from '@/schemas/newEventSchema';&#10;import { callSharepointAPI } from '@/utils/utils';&#10;import type { Session, SupabaseClient } from '@supabase/supabase-js';&#10;import { getEventDetailsById, getEventMasterByID } from '../supabase/events';&#10;import type { EventBesetzungAnwesenheitForm } from '@/schemas/eventBesetzungAnwesenheitSchema';&#10;import type { EventBewerbungForm } from '@/schemas/eventBewerbungSchema';&#10;&#10;export async function updateEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventMasterForm&#10;) {&#10;&#9;const { ...data } = formData;&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'update',&#10;&#9;&#9;itemId: formData.ID,&#10;&#9;&#9;formData: data,&#10;&#9;&#9;tableName: '4_EventMaster'&#10;&#9;});&#10;&#9;return;&#10;}&#10;&#10;export async function addEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventMasterForm&#10;) {&#10;&#9;const { ID, ...data } = formData;&#10;&#9;const return_ID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'insert',&#10;&#9;&#9;formData: data,&#10;&#9;&#9;tableName: '4_EventMaster'&#10;&#9;});&#10;&#9;return return_ID;&#10;}&#10;&#10;export async function deleteEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;ID: number&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'delete',&#10;&#9;&#9;itemId: ID,&#10;&#9;&#9;tableName: '4_EventMaster'&#10;&#9;});&#10;&#9;return;&#10;}&#10;&#10;export async function createNewEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: NewEventForm&#10;) {&#10;&#9;//transformData&#10;&#9;let transformedData = { ...formData } as any;&#10;&#9;transformedData['AnlageGew_x00fc_nscht'] = transformedData.AnlageGewuenscht;&#10;&#9;delete transformedData.AnlageGewuenscht;&#10;&#9;transformedData['BewerbungstextGew_x00fc_nscht'] = transformedData.BewerbungstextGewuenscht;&#10;&#9;delete transformedData.BewerbungstextGewuenscht;&#10;&#9;transformedData['AngabeEssgewGew_x00fc_nscht'] = transformedData.AngabeEssgewGewuenscht;&#10;&#9;delete transformedData.AngabeEssgewGewuenscht;&#10;&#9;delete transformedData.EventVerantwortliche; // Remove this field, as it will be handled separately&#10;&#9;delete transformedData.IstHSMEvent;&#10;&#9;delete transformedData.image;&#10;&#10;&#9;let { Eventart } = await getEventMasterByID(supabase, transformedData.MasterEventID);&#10;&#9;transformedData.Eventart = Eventart;&#10;&#10;&#9;let newEventID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'insert',&#10;&#9;&#9;formData: transformedData,&#10;&#9;&#9;tableName: '4_Events'&#10;&#9;});&#10;&#10;&#9;const eventVerantwortlicheIDs: number[] = [];&#10;&#9;for (const verantwortlicher of formData.EventVerantwortliche) {&#10;&#9;&#9;const eventVerantwortlicheID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;&#9;action: 'insert',&#10;&#9;&#9;&#9;formData: {&#10;&#9;&#9;&#9;&#9;Title: verantwortlicher.Titel,&#10;&#9;&#9;&#9;&#9;EventID: newEventID,&#10;&#9;&#9;&#9;&#9;MitgliedID: verantwortlicher.ID,&#10;&#9;&#9;&#9;&#9;Besetzt: true&#10;&#9;&#9;&#9;},&#10;&#9;&#9;&#9;tableName: '4_EventVerantwortliche'&#10;&#9;&#9;});&#10;&#9;&#9;eventVerantwortlicheIDs.push(eventVerantwortlicheID!);&#10;&#9;}&#10;&#10;&#9;return { newEventID, eventVerantwortlicheIDs };&#10;}&#10;&#10;export async function updateEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: NewEventForm,&#10;&#9;eventID: number&#10;) {&#10;&#9;let transformedData = { ...formData } as any;&#10;&#9;transformedData['AnlageGew_x00fc_nscht'] = transformedData.AnlageGewuenscht;&#10;&#9;delete transformedData.AnlageGewuenscht;&#10;&#9;transformedData['BewerbungstextGew_x00fc_nscht'] = transformedData.BewerbungstextGewuenscht;&#10;&#9;delete transformedData.BewerbungstextGewuenscht;&#10;&#9;transformedData['AngabeEssgewGew_x00fc_nscht'] = transformedData.AngabeEssgewGewuenscht;&#10;&#9;delete transformedData.AngabeEssgewGewuenscht;&#10;&#9;delete transformedData.EventVerantwortliche; // Remove this field, as it will be handled separately&#10;&#9;delete transformedData.IstHSMEvent;&#10;&#9;delete transformedData.image;&#10;&#10;&#9;let { Eventart } = await getEventMasterByID(supabase, transformedData.MasterEventID);&#10;&#9;transformedData.Eventart = Eventart;&#10;&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'update',&#10;&#9;&#9;itemId: eventID,&#10;&#9;&#9;formData: transformedData,&#10;&#9;&#9;tableName: '4_Events'&#10;&#9;});&#10;&#10;&#9;const { eventDetails } = await getEventDetailsById(supabase, eventID, 0);&#10;&#9;for (const ev of eventDetails.eventVerantwortliche) {&#10;&#9;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;&#9;action: 'delete',&#10;&#9;&#9;&#9;itemId: ev.ID,&#10;&#9;&#9;&#9;tableName: '4_EventVerantwortliche'&#10;&#9;&#9;});&#10;&#9;}&#10;&#10;&#9;const eventVerantwortlicheIDs: number[] = [];&#10;&#9;for (const ev of formData.EventVerantwortliche) {&#10;&#9;&#9;const eventVerantwortlicheID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;&#9;action: 'insert',&#10;&#9;&#9;&#9;formData: {&#10;&#9;&#9;&#9;&#9;Title: ev.Titel,&#10;&#9;&#9;&#9;&#9;EventID: eventID,&#10;&#9;&#9;&#9;&#9;MitgliedID: ev.ID,&#10;&#9;&#9;&#9;&#9;Besetzt: true&#10;&#9;&#9;&#9;},&#10;&#9;&#9;&#9;tableName: '4_EventVerantwortliche'&#10;&#9;&#9;});&#10;&#9;&#9;eventVerantwortlicheIDs.push(eventVerantwortlicheID!);&#10;&#9;}&#10;&#9;return eventVerantwortlicheIDs;&#10;}&#10;&#10;export async function createEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventBewerbungForm,&#10;&#9;eventId: number,&#10;&#9;userTitel: string,&#10;&#9;userId: number&#10;) {&#10;&#9;let besetzt: boolean = formData.Anmeldeart != 'Bewerben';&#10;&#10;&#9;const newApplicationID = await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'insert',&#10;&#9;&#9;formData: {&#10;&#9;&#9;&#9;Title: userTitel,&#10;&#9;&#9;&#9;EventID: eventId,&#10;&#9;&#9;&#9;MitgliedID: userId,&#10;&#9;&#9;&#9;BewerbungText: formData.BewerbungText,&#10;&#9;&#9;&#9;Besetzt: besetzt,&#10;&#9;&#9;&#9;Anwesend: false,&#10;&#9;&#9;&#9;Essgewohnheiten: formData.Essgewohnheiten&#10;&#9;&#9;},&#10;&#9;&#9;tableName: '4_EventBewerbungen'&#10;&#9;});&#10;&#9;return newApplicationID!;&#10;}&#10;&#10;export async function updateEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventBewerbungForm&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'update',&#10;&#9;&#9;formData: {&#10;&#9;&#9;&#9;BewerbungText: formData.BewerbungText,&#10;&#9;&#9;&#9;Essgewohnheiten: formData.Essgewohnheiten&#10;&#9;&#9;},&#10;&#9;&#9;tableName: '4_EventBewerbungen',&#10;&#9;&#9;itemId: formData.ID&#10;&#9;});&#10;}&#10;&#10;export async function deleteEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;applicationId: number&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'delete',&#10;&#9;&#9;itemId: applicationId,&#10;&#9;&#9;tableName: '4_EventBewerbungen'&#10;&#9;});&#10;}&#10;&#10;export async function deleteEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;eventId: number&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'delete',&#10;&#9;&#9;itemId: eventId,&#10;&#9;&#9;tableName: '4_Events'&#10;&#9;});&#10;}&#10;&#10;export async function setEventBesetzungAnwesenheit(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;session: Session,&#10;&#9;formData: EventBesetzungAnwesenheitForm&#10;) {&#10;&#9;await callSharepointAPI(supabase, session, {&#10;&#9;&#9;action: 'update',&#10;&#9;&#9;itemId: formData.ID,&#10;&#9;&#9;formData: {&#10;&#9;&#9;&#9;Besetzt: formData.Besetzt,&#10;&#9;&#9;&#9;Anwesend: formData.Anwesend&#10;&#9;&#9;},&#10;&#9;&#9;tableName: '4_EventBewerbungen'&#10;&#9;});&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/lib/api/supabase/events.ts">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/lib/api/supabase/events.ts" />
              <option name="originalContent" value="import type { Database } from '@/api/supabase/database.types';&#10;import type { EventMasterForm } from '@/schemas/eventMasterSchema';&#10;import type { NewEventForm } from '@/schemas/newEventSchema';&#10;import type { EventsFilterType } from '@/types/events';&#10;import {&#10;&#9;throwFetchErrorIfNeeded,&#10;&#9;throwSupabaseActionErrorIfNeeded,&#10;&#9;throwSupabaseErrorIfNeeded&#10;} from '@/utils/utils';&#10;import type { SupabaseClient } from '@supabase/supabase-js';&#10;import type { EventBewerbungForm } from '@/schemas/eventBewerbungSchema';&#10;import type { EventBesetzungAnwesenheitForm } from '@/schemas/eventBesetzungAnwesenheitSchema';&#10;&#10;export async function listEventsPaginatedFiltered(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;mitgliedID: number,&#10;&#9;filter: EventsFilterType,&#10;&#9;skip: number,&#10;&#9;limit: number&#10;) {&#10;&#9;let query = supabase&#10;&#9;&#9;.from('4_Events')&#10;&#9;&#9;.select(&#10;&#9;&#9;&#9;`ID, Titel, Beschreibung, Beginn, Ende, Bewerbungsdeadline, &#10;                eventMaster:4_EventMaster!inner(Titel, Eventart),&#10;                eventBewerbungen:4_EventBewerbungen(ID, MitgliedID, Besetzt, Anwesend)&#10;                `&#10;&#9;&#9;)&#10;&#9;&#9;.eq('eventBewerbungen.MitgliedID', mitgliedID)&#10;&#9;&#9;.neq('eventMaster.Eventart', 'HSM')&#10;&#9;&#9;.order('Beginn', { ascending: false })&#10;&#9;&#9;.range(skip, limit);&#10;&#10;&#9;if (filter.textSearch) query = query.ilike('Titel', `%${filter.textSearch}%`);&#10;&#9;switch (filter.dateFilter) {&#10;&#9;&#9;case 'upcoming':&#10;&#9;&#9;&#9;query = query.gte('Beginn', new Date().toISOString());&#10;&#9;&#9;&#9;break;&#10;&#9;&#9;case 'past':&#10;&#9;&#9;&#9;query = query.lt('Beginn', new Date().toISOString());&#10;&#9;&#9;&#9;break;&#10;&#9;}&#10;&#9;switch (filter.statusFilter) {&#10;&#9;&#9;case 'beworben':&#10;&#9;&#9;&#9;query = query.not('eventBewerbungen', 'is', null);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Besetzt', false);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Anwesend', false);&#10;&#9;&#9;&#9;break;&#10;&#9;&#9;case 'besetzt':&#10;&#9;&#9;&#9;query = query.not('eventBewerbungen', 'is', null);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Besetzt', true);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Anwesend', false);&#10;&#9;&#9;&#9;break;&#10;&#9;&#9;case 'anwesend':&#10;&#9;&#9;&#9;query = query.not('eventBewerbungen', 'is', null);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Anwesend', true);&#10;&#9;&#9;&#9;break;&#10;&#9;}&#10;&#10;&#9;let { data, error } = await query;&#10;&#9;if (error) console.log(error);&#10;&#9;data = throwSupabaseErrorIfNeeded(data, error, 'Events konnten nicht geladen werden');&#10;&#10;&#9;return data;&#10;}&#10;&#10;export async function getEventDetailsById(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;eventId: number,&#10;&#9;mitgliedId: number&#10;) {&#10;&#9;const eventQuery = supabase&#10;&#9;&#9;.from('4_Events')&#10;&#9;&#9;.select(&#10;&#9;&#9;&#9;`*,&#10;       eventMaster:4_EventMaster(*),&#10;       eventVerantwortliche:4_EventVerantwortliche(*, mitglieder:1_Mitglieder(*)),&#10;       userBewerbung:4_EventBewerbungen(*)`&#10;&#9;&#9;)&#10;&#9;&#9;.eq('ID', eventId)&#10;&#9;&#9;.eq('userBewerbung.MitgliedID', mitgliedId)&#10;&#9;&#9;.single();&#10;&#10;&#9;const totalAppsQuery = supabase.rpc('get_event_application_count', { event_id: eventId });&#10;&#10;&#9;/*const { data:imageUrlData, error:imageUrlError } = await supabase.functions.invoke(&#10;            'get-signed-storage-url',&#10;            {&#10;                method: 'POST',&#10;                body: JSON.stringify({bucketName: 'events', folderPath:'`titelbilder/${eventId}`', id:eventId}),&#10;            }&#10;        );&#10;        const {url} = imageUrlData;*/&#10;&#10;&#9;// Run all in parallel&#10;&#9;const [eventRes, totalAppsRes] = await Promise.all([eventQuery, totalAppsQuery]);&#10;&#10;&#9;const data = throwSupabaseErrorIfNeeded(&#10;&#9;&#9;eventRes.data,&#10;&#9;&#9;eventRes.error,&#10;&#9;&#9;'Event konnte nicht geladen werden'&#10;&#9;);&#10;&#10;&#9;const totalApplications = throwSupabaseErrorIfNeeded(&#10;&#9;&#9;totalAppsRes.data,&#10;&#9;&#9;totalAppsRes.error,&#10;&#9;&#9;'Anzahl der Bewerbungen konnte nicht geladen werden'&#10;&#9;);&#10;&#10;&#9;return { eventDetails: data, imageURL: null, totalApplications };&#10;}&#10;&#10;export async function getAllEventMasters(supabase: SupabaseClient&lt;Database&gt;) {&#10;&#9;let { data, error } = await supabase&#10;&#9;&#9;.from('4_EventMaster')&#10;&#9;&#9;.select('ID, Titel, MasterBeschreibung, Eventart');&#10;&#9;data = throwSupabaseErrorIfNeeded(data, error, 'Events Master konnten nicht geladen werden');&#10;&#9;data?.sort((a, b) =&gt; (b.Eventart ?? '').localeCompare(a.Eventart ?? ''));&#10;&#10;&#9;return data;&#10;}&#10;&#10;export async function updateEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventMasterForm&#10;) {&#10;&#9;const { error } = await supabase&#10;&#9;&#9;.from('4_EventMaster')&#10;&#9;&#9;.update({&#10;&#9;&#9;&#9;Titel: formData.Titel,&#10;&#9;&#9;&#9;MasterBeschreibung: formData.MasterBeschreibung,&#10;&#9;&#9;&#9;Eventart: formData.Eventart&#10;&#9;&#9;})&#10;&#9;&#9;.eq('ID', formData.ID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Event Master konnte nicht aktualisiert werden');&#10;&#9;return;&#10;}&#10;&#10;export async function deleteEventMaster(supabase: SupabaseClient&lt;Database&gt;, ID: number) {&#10;&#9;const { error } = await supabase.from('4_EventMaster').delete().eq('ID', ID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Event Master konnte nicht gelöscht werden');&#10;&#9;return;&#10;}&#10;&#10;export async function deleteEvent(supabase: SupabaseClient&lt;Database&gt;, ID: number) {&#10;&#9;const { error } = await supabase.from('4_Events').delete().eq('ID', ID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Event konnte nicht gelöscht werden');&#10;&#9;return;&#10;}&#10;&#10;export async function addEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventMasterForm,&#10;&#9;id: number&#10;) {&#10;&#9;const { error } = await supabase.from('4_EventMaster').insert({&#10;&#9;&#9;ID: id,&#10;&#9;&#9;Titel: formData.Titel,&#10;&#9;&#9;MasterBeschreibung: formData.MasterBeschreibung,&#10;&#9;&#9;Eventart: formData.Eventart&#10;&#9;});&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Event Master konnte nicht erstellt werden');&#10;&#9;return;&#10;}&#10;&#10;export async function getEventMasterByID(supabase: SupabaseClient&lt;Database&gt;, id: number) {&#10;&#9;const { data, error } = await supabase.from('4_EventMaster').select('*').eq('ID', id).single();&#10;&#9;let returnData = throwSupabaseErrorIfNeeded(&#10;&#9;&#9;data,&#10;&#9;&#9;error,&#10;&#9;&#9;'Event Master konnte nicht geladen werden'&#10;&#9;);&#10;&#9;return returnData;&#10;}&#10;&#10;export async function createNewEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;eventID: number,&#10;&#9;eventVerantwortlicheIDs: number[],&#10;&#9;formData: NewEventForm&#10;) {&#10;&#9;const { image, IstHSMEvent, EventVerantwortliche, ...eventData } = formData; // Explicitly exclude EventVerantwortliche&#10;&#9;const { error: eventError } = await supabase.from('4_Events').insert({&#10;&#9;&#9;...eventData,&#10;&#9;&#9;ID: eventID,&#10;&#9;&#9;Beginn: eventData.Beginn.toISOString(),&#10;&#9;&#9;Ende: eventData.Ende.toISOString(),&#10;&#9;&#9;Bewerbungsdeadline: eventData.Bewerbungsdeadline?.toISOString(),&#10;&#9;&#9;CheckInBeginn: eventData.CheckInBeginn?.toISOString(),&#10;&#9;&#9;Postleitzahl: eventData.Postleitzahl?.toString() || null,&#10;&#9;&#9;FCFSSlots: eventData.FCFSSlots || null&#10;&#9;});&#10;&#9;throwSupabaseActionErrorIfNeeded(eventError, 'Event konnte nicht erstellt werden');&#10;&#9;eventVerantwortlicheIDs.forEach(async (verantwortlicherEintragId, i) =&gt; {&#10;&#9;&#9;const { error: eventVerantwortlicherError } = await supabase&#10;&#9;&#9;&#9;.from('4_EventVerantwortliche')&#10;&#9;&#9;&#9;.insert({&#10;&#9;&#9;&#9;&#9;ID: verantwortlicherEintragId,&#10;&#9;&#9;&#9;&#9;Titel: EventVerantwortliche[i].Titel,&#10;&#9;&#9;&#9;&#9;EventID: eventID,&#10;&#9;&#9;&#9;&#9;MitgliedID: EventVerantwortliche[i].ID,&#10;&#9;&#9;&#9;&#9;Besetzt: true&#10;&#9;&#9;&#9;});&#10;&#9;&#9;throwSupabaseActionErrorIfNeeded(&#10;&#9;&#9;&#9;eventVerantwortlicherError,&#10;&#9;&#9;&#9;'Event Verantwortlicher konnte nicht erstellt werden'&#10;&#9;&#9;);&#10;&#9;});&#10;&#10;&#9;//upload image&#10;&#9;if (image &amp;&amp; image.size &gt; 0) {&#10;&#9;&#9;const ext = image.name.split('.').pop();&#10;&#9;&#9;const path = `titelbilder/${eventID}/${eventID}.${ext}`;&#10;&#10;&#9;&#9;const { error: imageUploadError } = await supabase.storage.from('events').upload(path, image);&#10;&#9;&#9;console.log(imageUploadError);&#10;&#9;&#9;if (imageUploadError) return imageUploadError;&#10;&#9;}&#10;&#10;&#9;return eventError;&#10;}&#10;&#10;export async function updateEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: NewEventForm,&#10;&#9;eventVerantwortlicheIDs: number[],&#10;&#9;eventId: number&#10;) {&#10;&#9;const { image, IstHSMEvent, EventVerantwortliche, ...eventData } = formData;&#10;&#10;&#9;const { error: eventError } = await supabase&#10;&#9;&#9;.from('4_Events')&#10;&#9;&#9;.update({&#10;&#9;&#9;&#9;...eventData,&#10;&#9;&#9;&#9;Beginn: eventData.Beginn.toISOString(),&#10;&#9;&#9;&#9;Ende: eventData.Ende.toISOString(),&#10;&#9;&#9;&#9;Bewerbungsdeadline: eventData.Bewerbungsdeadline?.toISOString(),&#10;&#9;&#9;&#9;CheckInBeginn: eventData.CheckInBeginn?.toISOString(),&#10;&#9;&#9;&#9;Postleitzahl: eventData.Postleitzahl?.toString() || null,&#10;&#9;&#9;&#9;FCFSSlots: eventData.FCFSSlots || null&#10;&#9;&#9;})&#10;&#9;&#9;.eq('ID', eventId);&#10;&#9;if (eventError) return eventError;&#10;&#10;&#9;// Reset Verantwortliche&#10;&#9;const { error: deleteError } = await supabase&#10;&#9;&#9;.from('4_EventVerantwortliche')&#10;&#9;&#9;.delete()&#10;&#9;&#9;.eq('EventID', eventId);&#10;&#9;if (deleteError) return deleteError;&#10;&#10;&#9;for (const [i, verantwortlicherEintragId] of eventVerantwortlicheIDs.entries()) {&#10;&#9;&#9;const { error: eventVerantwortlicherError } = await supabase&#10;&#9;&#9;&#9;.from('4_EventVerantwortliche')&#10;&#9;&#9;&#9;.insert({&#10;&#9;&#9;&#9;&#9;ID: verantwortlicherEintragId,&#10;&#9;&#9;&#9;&#9;Titel: EventVerantwortliche[i].Titel,&#10;&#9;&#9;&#9;&#9;EventID: eventId,&#10;&#9;&#9;&#9;&#9;MitgliedID: EventVerantwortliche[i].ID,&#10;&#9;&#9;&#9;&#9;Besetzt: true&#10;&#9;&#9;&#9;});&#10;&#9;&#9;if (eventVerantwortlicherError) return eventVerantwortlicherError;&#10;&#9;}&#10;&#10;&#9;if (image &amp;&amp; image.size &gt; 0) {&#10;&#9;&#9;const ext = image.name.split('.').pop();&#10;&#9;&#9;const path = `titelbilder/${eventId}/${eventId}.${ext}`;&#10;&#9;&#9;const { error: imageUploadError } = await supabase.storage&#10;&#9;&#9;&#9;.from('events')&#10;&#9;&#9;&#9;.upload(path, image, { upsert: true });&#10;&#9;&#9;if (imageUploadError) return imageUploadError;&#10;&#9;}&#10;&#10;&#9;return eventError;&#10;}&#10;&#10;export async function createEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventBewerbungForm,&#10;&#9;applicationID: number,&#10;&#9;userTitel: string,&#10;&#9;eventID: number,&#10;&#9;userID: number&#10;) {&#10;&#9;let besetzt: boolean = formData.Anmeldeart != 'Bewerben';&#10;&#10;&#9;const { error: bewerbungError } = await supabase.from('4_EventBewerbungen').insert({&#10;&#9;&#9;ID: applicationID,&#10;&#9;&#9;Titel: userTitel,&#10;&#9;&#9;EventID: eventID,&#10;&#9;&#9;MitgliedID: userID,&#10;&#9;&#9;BewerbungText: formData.BewerbungText,&#10;&#9;&#9;Besetzt: besetzt,&#10;&#9;&#9;Anwesend: false,&#10;&#9;&#9;Essgewohnheiten: formData.Essgewohnheiten&#10;&#9;});&#10;&#9;throwSupabaseActionErrorIfNeeded(bewerbungError, 'Bewerbung konnte nicht gesendet werden');&#10;&#10;&#9;if (formData.Anlage) {&#10;&#9;&#9;const { error: anlageError } = await supabase.storage&#10;&#9;&#9;&#9;.from('events')&#10;&#9;&#9;&#9;.upload(&#10;&#9;&#9;&#9;&#9;`bewerbungenAnhang/${eventID}/${applicationID}.${formData.Anlage.name.split('.').pop()}`,&#10;&#9;&#9;&#9;&#9;formData.Anlage&#10;&#9;&#9;&#9;);&#10;&#9;&#9;throwSupabaseActionErrorIfNeeded(anlageError, 'Anlage konnte nicht gesendet werden');&#10;&#9;}&#10;&#10;&#9;return;&#10;}&#10;&#10;export async function updateEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventBewerbungForm&#10;) {&#10;&#9;const { error } = await supabase&#10;&#9;&#9;.from('4_EventBewerbungen')&#10;&#9;&#9;.update({&#10;&#9;&#9;&#9;BewerbungText: formData.BewerbungText,&#10;&#9;&#9;&#9;Essgewohnheiten: formData.Essgewohnheiten&#10;&#9;&#9;})&#10;&#9;&#9;.eq('ID', formData.ID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Bewerbung konnte nicht aktualisiert werden');&#10;&#9;return;&#10;}&#10;&#10;export async function deleteEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;applicationID: number&#10;) {&#10;&#9;const { error } = await supabase.from('4_EventBewerbungen').delete().eq('ID', applicationID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Bewerbung konnte nicht gelöscht werden');&#10;}&#10;&#10;export async function getEventApplications(supabase: SupabaseClient&lt;Database&gt;, eventId: number) {&#10;&#9;let { data, error } = await supabase&#10;&#9;&#9;.from('4_EventBewerbungen')&#10;&#9;&#9;.select(`ID, MitgliedID, EventID, Besetzt, Anwesend, Titel, BewerbungText, Essgewohnheiten`)&#10;&#9;&#9;.eq('EventID', eventId)&#10;&#9;&#9;.order('Titel', { ascending: false });&#10;&#10;&#9;data = throwFetchErrorIfNeeded(data, error, 'Bewerbungen konnten nicht geladen werden');&#10;&#9;return data;&#10;}&#10;&#10;export async function setEventBesetzungAnwesenheit(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventBesetzungAnwesenheitForm&#10;) {&#10;&#9;let { error } = await supabase&#10;&#9;&#9;.from('4_EventBewerbungen')&#10;&#9;&#9;.update({&#10;&#9;&#9;&#9;Besetzt: formData.Besetzt,&#10;&#9;&#9;&#9;Anwesend: formData.Anwesend&#10;&#9;&#9;})&#10;&#9;&#9;.eq('ID', formData.ID);&#10;&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Besetzung/Anwesenheit konnte nicht gesetzt werden');&#10;&#9;return;&#10;}&#10;" />
              <option name="updatedContent" value="import type { Database } from '@/api/supabase/database.types';&#10;import type { EventMasterForm } from '@/schemas/eventMasterSchema';&#10;import type { NewEventForm } from '@/schemas/newEventSchema';&#10;import type { EventsFilterType } from '@/types/events';&#10;import {&#10;&#9;throwFetchErrorIfNeeded,&#10;&#9;throwSupabaseActionErrorIfNeeded,&#10;&#9;throwSupabaseErrorIfNeeded&#10;} from '@/utils/utils';&#10;import type { SupabaseClient } from '@supabase/supabase-js';&#10;import type { EventBewerbungForm } from '@/schemas/eventBewerbungSchema';&#10;import type { EventBesetzungAnwesenheitForm } from '@/schemas/eventBesetzungAnwesenheitSchema';&#10;&#10;export async function listEventsPaginatedFiltered(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;mitgliedID: number,&#10;&#9;filter: EventsFilterType,&#10;&#9;skip: number,&#10;&#9;limit: number&#10;) {&#10;&#9;let query = supabase&#10;&#9;&#9;.from('4_Events')&#10;&#9;&#9;.select(&#10;&#9;&#9;&#9;`ID, Titel, Beschreibung, Beginn, Ende, Bewerbungsdeadline, &#10;                eventMaster:4_EventMaster!inner(Titel, Eventart),&#10;                eventBewerbungen:4_EventBewerbungen(ID, MitgliedID, Besetzt, Anwesend)&#10;                `&#10;&#9;&#9;)&#10;&#9;&#9;.eq('eventBewerbungen.MitgliedID', mitgliedID)&#10;&#9;&#9;.neq('eventMaster.Eventart', 'HSM')&#10;&#9;&#9;.order('Beginn', { ascending: false })&#10;&#9;&#9;.range(skip, limit);&#10;&#10;&#9;if (filter.textSearch) query = query.ilike('Titel', `%${filter.textSearch}%`);&#10;&#9;switch (filter.dateFilter) {&#10;&#9;&#9;case 'upcoming':&#10;&#9;&#9;&#9;query = query.gte('Beginn', new Date().toISOString());&#10;&#9;&#9;&#9;break;&#10;&#9;&#9;case 'past':&#10;&#9;&#9;&#9;query = query.lt('Beginn', new Date().toISOString());&#10;&#9;&#9;&#9;break;&#10;&#9;}&#10;&#9;switch (filter.statusFilter) {&#10;&#9;&#9;case 'beworben':&#10;&#9;&#9;&#9;query = query.not('eventBewerbungen', 'is', null);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Besetzt', false);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Anwesend', false);&#10;&#9;&#9;&#9;break;&#10;&#9;&#9;case 'besetzt':&#10;&#9;&#9;&#9;query = query.not('eventBewerbungen', 'is', null);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Besetzt', true);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Anwesend', false);&#10;&#9;&#9;&#9;break;&#10;&#9;&#9;case 'anwesend':&#10;&#9;&#9;&#9;query = query.not('eventBewerbungen', 'is', null);&#10;&#9;&#9;&#9;query = query.eq('eventBewerbungen.Anwesend', true);&#10;&#9;&#9;&#9;break;&#10;&#9;}&#10;&#10;&#9;let { data, error } = await query;&#10;&#9;if (error) console.log(error);&#10;&#9;data = throwSupabaseErrorIfNeeded(data, error, 'Events konnten nicht geladen werden');&#10;&#10;&#9;return data;&#10;}&#10;&#10;export async function getEventDetailsById(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;eventId: number,&#10;&#9;mitgliedId: number&#10;) {&#10;&#9;const eventQuery = supabase&#10;&#9;&#9;.from('4_Events')&#10;&#9;&#9;.select(&#10;&#9;&#9;&#9;`*,&#10;       eventMaster:4_EventMaster(*),&#10;       eventVerantwortliche:4_EventVerantwortliche(*, mitglieder:1_Mitglieder(*)),&#10;       userBewerbung:4_EventBewerbungen(*)`&#10;&#9;&#9;)&#10;&#9;&#9;.eq('ID', eventId)&#10;&#9;&#9;.eq('userBewerbung.MitgliedID', mitgliedId)&#10;&#9;&#9;.single();&#10;&#10;&#9;const totalAppsQuery = supabase.rpc('get_event_application_count', { event_id: eventId });&#10;&#10;&#9;/*const { data:imageUrlData, error:imageUrlError } = await supabase.functions.invoke(&#10;            'get-signed-storage-url',&#10;            {&#10;                method: 'POST',&#10;                body: JSON.stringify({bucketName: 'events', folderPath:'`titelbilder/${eventId}`', id:eventId}),&#10;            }&#10;        );&#10;        const {url} = imageUrlData;*/&#10;&#10;&#9;// Run all in parallel&#10;&#9;const [eventRes, totalAppsRes] = await Promise.all([eventQuery, totalAppsQuery]);&#10;&#10;&#9;const data = throwSupabaseErrorIfNeeded(&#10;&#9;&#9;eventRes.data,&#10;&#9;&#9;eventRes.error,&#10;&#9;&#9;'Event konnte nicht geladen werden'&#10;&#9;);&#10;&#10;&#9;const totalApplications = throwSupabaseErrorIfNeeded(&#10;&#9;&#9;totalAppsRes.data,&#10;&#9;&#9;totalAppsRes.error,&#10;&#9;&#9;'Anzahl der Bewerbungen konnte nicht geladen werden'&#10;&#9;);&#10;&#10;&#9;return { eventDetails: data, imageURL: null, totalApplications };&#10;}&#10;&#10;export async function getAllEventMasters(supabase: SupabaseClient&lt;Database&gt;) {&#10;&#9;let { data, error } = await supabase&#10;&#9;&#9;.from('4_EventMaster')&#10;&#9;&#9;.select('ID, Titel, MasterBeschreibung, Eventart');&#10;&#9;data = throwSupabaseErrorIfNeeded(data, error, 'Events Master konnten nicht geladen werden');&#10;&#9;data?.sort((a, b) =&gt; (b.Eventart ?? '').localeCompare(a.Eventart ?? ''));&#10;&#10;&#9;return data;&#10;}&#10;&#10;export async function updateEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventMasterForm&#10;) {&#10;&#9;const { error } = await supabase&#10;&#9;&#9;.from('4_EventMaster')&#10;&#9;&#9;.update({&#10;&#9;&#9;&#9;Titel: formData.Titel,&#10;&#9;&#9;&#9;MasterBeschreibung: formData.MasterBeschreibung,&#10;&#9;&#9;&#9;Eventart: formData.Eventart&#10;&#9;&#9;})&#10;&#9;&#9;.eq('ID', formData.ID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Event Master konnte nicht aktualisiert werden');&#10;&#9;return;&#10;}&#10;&#10;export async function deleteEventMaster(supabase: SupabaseClient&lt;Database&gt;, ID: number) {&#10;&#9;const { error } = await supabase.from('4_EventMaster').delete().eq('ID', ID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Event Master konnte nicht gelöscht werden');&#10;&#9;return;&#10;}&#10;&#10;export async function deleteEvent(supabase: SupabaseClient&lt;Database&gt;, ID: number) {&#10;&#9;const { error } = await supabase.from('4_Events').delete().eq('ID', ID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Event konnte nicht gelöscht werden');&#10;&#9;return;&#10;}&#10;&#10;export async function addEventMaster(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventMasterForm,&#10;&#9;id: number&#10;) {&#10;&#9;const { error } = await supabase.from('4_EventMaster').insert({&#10;&#9;&#9;ID: id,&#10;&#9;&#9;Titel: formData.Titel,&#10;&#9;&#9;MasterBeschreibung: formData.MasterBeschreibung,&#10;&#9;&#9;Eventart: formData.Eventart&#10;&#9;});&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Event Master konnte nicht erstellt werden');&#10;&#9;return;&#10;}&#10;&#10;export async function getEventMasterByID(supabase: SupabaseClient&lt;Database&gt;, id: number) {&#10;&#9;const { data, error } = await supabase.from('4_EventMaster').select('*').eq('ID', id).single();&#10;&#9;let returnData = throwSupabaseErrorIfNeeded(&#10;&#9;&#9;data,&#10;&#9;&#9;error,&#10;&#9;&#9;'Event Master konnte nicht geladen werden'&#10;&#9;);&#10;&#9;return returnData;&#10;}&#10;&#10;export async function createNewEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;eventID: number,&#10;&#9;eventVerantwortlicheIDs: number[],&#10;&#9;formData: NewEventForm&#10;) {&#10;&#9;const { image, IstHSMEvent, EventVerantwortliche, ...eventData } = formData; // Explicitly exclude EventVerantwortliche&#10;&#9;const { error: eventError } = await supabase.from('4_Events').insert({&#10;&#9;&#9;...eventData,&#10;&#9;&#9;ID: eventID,&#10;&#9;&#9;Beginn: eventData.Beginn.toISOString(),&#10;&#9;&#9;Ende: eventData.Ende.toISOString(),&#10;&#9;&#9;Bewerbungsdeadline: eventData.Bewerbungsdeadline?.toISOString(),&#10;&#9;&#9;CheckInBeginn: eventData.CheckInBeginn?.toISOString(),&#10;&#9;&#9;Postleitzahl: eventData.Postleitzahl?.toString() || null,&#10;&#9;&#9;FCFSSlots: eventData.FCFSSlots || null&#10;&#9;});&#10;&#9;throwSupabaseActionErrorIfNeeded(eventError, 'Event konnte nicht erstellt werden');&#10;&#9;eventVerantwortlicheIDs.forEach(async (verantwortlicherEintragId, i) =&gt; {&#10;&#9;&#9;const { error: eventVerantwortlicherError } = await supabase&#10;&#9;&#9;&#9;.from('4_EventVerantwortliche')&#10;&#9;&#9;&#9;.insert({&#10;&#9;&#9;&#9;&#9;ID: verantwortlicherEintragId,&#10;&#9;&#9;&#9;&#9;Titel: EventVerantwortliche[i].Titel,&#10;&#9;&#9;&#9;&#9;EventID: eventID,&#10;&#9;&#9;&#9;&#9;MitgliedID: EventVerantwortliche[i].ID,&#10;&#9;&#9;&#9;&#9;Besetzt: true&#10;&#9;&#9;&#9;});&#10;&#9;&#9;throwSupabaseActionErrorIfNeeded(&#10;&#9;&#9;&#9;eventVerantwortlicherError,&#10;&#9;&#9;&#9;'Event Verantwortlicher konnte nicht erstellt werden'&#10;&#9;&#9;);&#10;&#9;});&#10;&#10;&#9;//upload image&#10;&#9;if (image &amp;&amp; image.size &gt; 0) {&#10;&#9;&#9;const ext = image.name.split('.').pop();&#10;&#9;&#9;const path = `titelbilder/${eventID}/${eventID}.${ext}`;&#10;&#10;&#9;&#9;const { error: imageUploadError } = await supabase.storage.from('events').upload(path, image);&#10;&#9;&#9;console.log(imageUploadError);&#10;&#9;&#9;if (imageUploadError) return imageUploadError;&#10;&#9;}&#10;&#10;&#9;return eventError;&#10;}&#10;&#10;export async function updateEvent(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: NewEventForm,&#10;&#9;eventVerantwortlicheIDs: number[],&#10;&#9;eventId: number&#10;) {&#10;&#9;const { image, IstHSMEvent, EventVerantwortliche, ...eventData } = formData;&#10;&#10;&#9;const { error: eventError } = await supabase&#10;&#9;&#9;.from('4_Events')&#10;&#9;&#9;.update({&#10;&#9;&#9;&#9;...eventData,&#10;&#9;&#9;&#9;Beginn: eventData.Beginn.toISOString(),&#10;&#9;&#9;&#9;Ende: eventData.Ende.toISOString(),&#10;&#9;&#9;&#9;Bewerbungsdeadline: eventData.Bewerbungsdeadline?.toISOString(),&#10;&#9;&#9;&#9;CheckInBeginn: eventData.CheckInBeginn?.toISOString(),&#10;&#9;&#9;&#9;Postleitzahl: eventData.Postleitzahl?.toString() || null,&#10;&#9;&#9;&#9;FCFSSlots: eventData.FCFSSlots || null&#10;&#9;&#9;})&#10;&#9;&#9;.eq('ID', eventId);&#10;&#9;if (eventError) return eventError;&#10;&#10;&#9;// Reset Verantwortliche&#10;&#9;const { error: deleteError } = await supabase&#10;&#9;&#9;.from('4_EventVerantwortliche')&#10;&#9;&#9;.delete()&#10;&#9;&#9;.eq('EventID', eventId);&#10;&#9;if (deleteError) return deleteError;&#10;&#10;&#9;for (const [i, verantwortlicherEintragId] of eventVerantwortlicheIDs.entries()) {&#10;&#9;&#9;const { error: eventVerantwortlicherError } = await supabase&#10;&#9;&#9;&#9;.from('4_EventVerantwortliche')&#10;&#9;&#9;&#9;.insert({&#10;&#9;&#9;&#9;&#9;ID: verantwortlicherEintragId,&#10;&#9;&#9;&#9;&#9;Titel: EventVerantwortliche[i].Titel,&#10;&#9;&#9;&#9;&#9;EventID: eventId,&#10;&#9;&#9;&#9;&#9;MitgliedID: EventVerantwortliche[i].ID,&#10;&#9;&#9;&#9;&#9;Besetzt: true&#10;&#9;&#9;&#9;});&#10;&#9;&#9;if (eventVerantwortlicherError) return eventVerantwortlicherError;&#10;&#9;}&#10;&#10;&#9;if (image &amp;&amp; image.size &gt; 0) {&#10;&#9;&#9;const ext = image.name.split('.').pop();&#10;&#9;&#9;const path = `titelbilder/${eventId}/${eventId}.${ext}`;&#10;&#9;&#9;const { error: imageUploadError } = await supabase.storage&#10;&#9;&#9;&#9;.from('events')&#10;&#9;&#9;&#9;.upload(path, image, { upsert: true });&#10;&#9;&#9;if (imageUploadError) return imageUploadError;&#10;&#9;}&#10;&#10;&#9;return eventError;&#10;}&#10;&#10;export async function createEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventBewerbungForm,&#10;&#9;applicationID: number,&#10;&#9;userTitel: string,&#10;&#9;eventID: number,&#10;&#9;userID: number&#10;) {&#10;&#9;let besetzt: boolean = formData.Anmeldeart != 'Bewerben';&#10;&#10;&#9;const { error: bewerbungError } = await supabase.from('4_EventBewerbungen').insert({&#10;&#9;&#9;ID: applicationID,&#10;&#9;&#9;Titel: userTitel,&#10;&#9;&#9;EventID: eventID,&#10;&#9;&#9;MitgliedID: userID,&#10;&#9;&#9;BewerbungText: formData.BewerbungText,&#10;&#9;&#9;Besetzt: besetzt,&#10;&#9;&#9;Anwesend: false,&#10;&#9;&#9;Essgewohnheiten: formData.Essgewohnheiten&#10;&#9;});&#10;&#9;throwSupabaseActionErrorIfNeeded(bewerbungError, 'Bewerbung konnte nicht gesendet werden');&#10;&#10;&#9;if (formData.Anlage) {&#10;&#9;&#9;const { error: anlageError } = await supabase.storage&#10;&#9;&#9;&#9;.from('events')&#10;&#9;&#9;&#9;.upload(&#10;&#9;&#9;&#9;&#9;`bewerbungenAnhang/${eventID}/${applicationID}.${formData.Anlage.name.split('.').pop()}`,&#10;&#9;&#9;&#9;&#9;formData.Anlage&#10;&#9;&#9;&#9;);&#10;&#9;&#9;throwSupabaseActionErrorIfNeeded(anlageError, 'Anlage konnte nicht gesendet werden');&#10;&#9;}&#10;&#10;&#9;return;&#10;}&#10;&#10;export async function updateEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventBewerbungForm&#10;) {&#10;&#9;const { error } = await supabase&#10;&#9;&#9;.from('4_EventBewerbungen')&#10;&#9;&#9;.update({&#10;&#9;&#9;&#9;BewerbungText: formData.BewerbungText,&#10;&#9;&#9;&#9;Essgewohnheiten: formData.Essgewohnheiten&#10;&#9;&#9;})&#10;&#9;&#9;.eq('ID', formData.ID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Bewerbung konnte nicht aktualisiert werden');&#10;&#9;return;&#10;}&#10;&#10;export async function deleteEventApplication(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;applicationID: number&#10;) {&#10;&#9;const { error } = await supabase.from('4_EventBewerbungen').delete().eq('ID', applicationID);&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Bewerbung konnte nicht gelöscht werden');&#10;}&#10;&#10;export async function getEventApplications(supabase: SupabaseClient&lt;Database&gt;, eventId: number) {&#10;&#9;let { data, error } = await supabase&#10;&#9;&#9;.from('4_EventBewerbungen')&#10;&#9;&#9;.select(`ID, MitgliedID, EventID, Besetzt, Anwesend, Titel, BewerbungText, Essgewohnheiten`)&#10;&#9;&#9;.eq('EventID', eventId)&#10;&#9;&#9;.order('Titel', { ascending: false });&#10;&#10;&#9;data = throwFetchErrorIfNeeded(data, error, 'Bewerbungen konnten nicht geladen werden');&#10;&#9;return data;&#10;}&#10;&#10;export async function setEventBesetzungAnwesenheit(&#10;&#9;supabase: SupabaseClient&lt;Database&gt;,&#10;&#9;formData: EventBesetzungAnwesenheitForm&#10;) {&#10;&#9;let { error } = await supabase&#10;&#9;&#9;.from('4_EventBewerbungen')&#10;&#9;&#9;.update({&#10;&#9;&#9;&#9;Besetzt: formData.Besetzt,&#10;&#9;&#9;&#9;Anwesend: formData.Anwesend&#10;&#9;&#9;})&#10;&#9;&#9;.eq('ID', formData.ID);&#10;&#10;&#9;throwSupabaseActionErrorIfNeeded(error, 'Besetzung/Anwesenheit konnte nicht gesetzt werden');&#10;&#9;return;&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>